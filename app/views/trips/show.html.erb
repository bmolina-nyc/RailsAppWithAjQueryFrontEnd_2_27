<!DOCTYPE html>
<html>
<head>
  <title></title>
<style>
      #container {
        background-color: lightblue;
        height: 250px;
        width: 30%;
        padding-left: 5px;
        }

      input {
      margin-bottom: 20px;
      }

      h4 {
        text-align: center;
        padding-top: 5px;
      }
    </style>
</head>
<body>

  <a href="#" class="js-next" data-id="<%=@trip.id%>">Next Trip</a>
  <h1 class="tripTitle"><%= @trip.name %></h1>
  <div class="tripImage"> <%= image_tag 'trip_1.jpeg', alt: "trip1", width: "240px", height: "160px" %> </div>
  <p class="tripBody"><%= @trip.description %></p>


  <div id="container">
  <h4>Get The Current Weather in <%= @trip.name %></h4>
  <div>
    <label for="city">City</label>
    <input label="City" id="city" type="text" value= "<%= @trip.name %>" readonly >
    <br>
    <label for="city">Country</label>
    <input label="Country" id="country" type="text" value= "<%= @trip.country%>" readonly>
  </div>

  <button id="btnGetWeather" type="button">Get Weather Data</button>
  
  <br><br>

  <div id = "resultsDiv">
  </div>

</div>






<script type="text/javascript">
      $(document).ready(function (){
        $('#btnGetWeather').click(function(){
          // the data from the inputs
          var requestData = $('#city').val() + ',' + $('#country').val();
          var resultElement = $('#resultsDiv');

          //the API call 
          $.ajax({
            url: `http://api.openweathermap.org/data/2.5/weather?q=${requestData}&APPID=8971378f99c3f36f5f8322ef875fa787`,
            method: 'get',
            dataType: 'json',
            success: function(data){
                resultElement.html('Weather: ' + data.weather[0].main + '<br/>' + 
                  'Description: ' + data.weather[0].description);
                  }
                }).fail(function(error) {
                    resultElement.html("No information Found!")
                  });
                });
              });
</script>




<!-- rotate through the different trips -->
  <script type="text/javascript" charset="utf-8">
  $(function () {
    $(".js-next").on("click", function() {
      event.stopPropagation()
      var nextId = parseInt($(".js-next").attr("data-id")) + 1;
      $.get("/trips/" + nextId + ".json", function(data) {
        // get post
        var trip_data = data;
        console.log(data)
        $(".tripTitle").text(trip_data["name"]);
        $(".tripBody").text(trip_data["description"]);
        // re-set the id to current on the link
        $(".js-next").attr("data-id", trip_data["id"]);
      });
    });
  });
  </script>






</body>
</html>
 